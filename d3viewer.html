<!DOCTYPE html>
<html>
<head>
    <title>MatrixViewer - UW Graphics Group</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    
    <!-- boostrap -->
    <link href="lib/bootstrap.min.css" rel="stylesheet" />
    <link href="lib/bootstrap-slider.css" rel="stylesheet" />
    
    <!-- local stylesheet -->
    <link rel="stylesheet" href="style.css" />
    
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">
                <img src="img/logo.png" class="img-responsive pull-left"> 
                Co-Occurrence D3Viewer
            </a>
        </div>
        <div class="collapse navbar-collapse" id="navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li>
                    <a href="#" data-toggle="modal" data-target="#faq">How to use</a>
                </li>
                <li>
                    <div class="btn-group navbar-btn" id="datasetChooser">
                        <button type="button" class="btn btn-primary" id="currentDataset">SHFV</button>
                        <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
                            <span class="caret"></span>
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <ul class="dropdown-menu" role="menu" id="datasetOptions">
                            <li><a href="#">[loading...]</a></li>
                            <li><a href="#">SHIV</a></li>
                        </ul>
                    </div>
                </li>
            </ul>
            
            <p class="navbar-text navbar-right"><small>
                Test interface for finding interesting co-occurence locations
            </small></p>
        </div>
    </div>
</nav>

<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <svg id="d3canvas" version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg"></svg>
        </div>
    </div>
    <div class="row" id="d3-sliders">
        <div class="col-sm-4" id="depth-slider">
            <label for="threshold-depth">
                Read Depth threshold: 
            </label>
            <input id="threshold-depth" type="text" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="25" />
        </div>
        <div class="col-sm-4" id="variant-slider">
            <label for="threshold-variants">
                Variant % threshold: 
            </label>
            <input id="threshold-variants" type="text" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="10" />
        </div>
        <div class="col-sm-4" id="metric-slider">
            <label for="threshold-metric">
                Co-occurrence threshold: 
            </label>
            <input id="threshold-metric" type="text" data-slider-min="0" data-slider-max="1" data-slider-step="0.02" data-slider-value="0.3" />
        </div>
    </div>
</div>

<div id="faq" class="modal fade" tabIndex="-2" role="dialog" aria-labelledby="faqLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="faqLabel">How to Use MatrixViewer JS</h4>
            </div>
            <div class="modal-body">
                <p>
                    This project is a JavaScript implementation of viewing data encoded in a matrix around the matrix diagonal.  The current use case is to find co-occurrences in viral populations, which can indicate how viruses adapt to environmental pressures, such as the host organism's immune system.
                </p><p>
                    This current implementation is architected by <a href="http://cs.wisc.edu/~sarikaya" target="_blank">Alper Sarikaya</a> to test the practicality of WebGL as a visualization medium.  The project is version-controlled in a private repository.  The stable version of the visualization is available (temporarily) <a href="http://cs.wisc.edu/~sarikaya/static/cooccur" target="_new">here</a>, while an in-progress version is available <a href="http://cs.wisc.edu/~sarikaya/research/cooccur" target="_new">here</a>.
                </p>
                <p>&nbsp;</p>
                
                <h4>Interacting with the Data</h4>
                <p>
                    The data is displayed diagonally by default, with the <strong>i</strong>th position on the y-axis, and the <strong>j</strong>th position on the x-axis.  The following methods itemize the ways to interact with the visualization.
                </p>
                    
                <ul id="interactionList">
                    <li><em class="stronk">Clicking in the overview</em> will navigate the main view to the area highlighted by the green bar.  The mouse must stay within the top bar when panning the dataset.</li>
                    <li><em class="stronk">Using the scroll wheel</em> within the canvas will change the zoom level of the current view.  The position of the cursor will focus the area of zoom, but the zoom position will always be fixed toward the diagonal of the matrix.</li>
                    <li><em class="stronk">Hovering the mouse</em> over the dataset at a particular position brings up the encoded data in the 'super-zoom' at top-right, which shows the a view of the current coordinates and metric value(s) under the mouse.</li>
                    <li><em class="stronk">Clicking the dataset</em> will freeze the 'super-zoom' (which will blink), allowing for more detailed examination of the data.  Further, <em class="stronk">clicking on a 'pixel' in the 'super-zoom'</em> will display the counts of non-variant and variant reads in the below view.</li>
                    <li><em class="stronk">Clicking a count rectangle</em> in the counts view will condition the reads of the paired read.  This conditioned view can be reset by again clicking on the appropriate pixel in the 'super-zoom.'</li>
                    <li><em class="stronk">Switching the <strong>metric</strong></em> will cause the visualization to ask for the data file (up to 15 seconds) and load it into the visualization (1 second).  The equation used to compute each metric is displayed below the drop-down.</li>
                    <li><em class="stronk">Enabling <strong>gating</strong></em> will blank out any color if the <strong>i</strong>th position does not contain at least <strong>x%</strong> variants.  This helps to elimate noise in the visualization and promotes salience of highly-correlated variants.</li>
                </ul>
                <p>&nbsp;</p>
                
                <h4>Implementation Notes</h4>
                <p>
                    This implementation has been tested in Google Chrome (v36) and Firefox (v32).  Client computers must support WebGL (GPU, drivers, browser, OS) and the <strong>OES_float_texture</strong> WebGL extension for correct rendering. Check WebGL support of your current configuration on <a href="http://webglreport.com/" target="_blank">WebGL Report</a>. Internet Explorer and Safari do not support WebGL due to security concerns.
                </p>
            </div>
            <div class="modal-footer">
                <p class="pull-left small" style="margin-top: 10px;">&copy; 2014 &mdash; <a href="http://graphics.cs.wisc.edu" target="_new">UW Graphics Group</a>, <a href="http://wisc.edu" target="_new">University of Wisconsin-Madison</a></p>
                <button class="btn btn-success" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

    <!-- load scripts down here -->
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <!--<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>-->
    <script src="lib/d3.min.js" charset="utf-8"></script>
    
    <!-- helps with parsing mousewheel events -->
    <script type="text/javascript" src="lib/jquery.mousewheel.js"></script>
    <script type="text/javascript" src="lib/d3-tip.js"></script>
    
    <!-- boostrap -->
    <script type="text/javascript" src="lib/bootstrap.min.js"></script>
    <script type="text/javascript" src="lib/bootstrap-slider.js"></script>
    
    <!-- adds ability to push/pop matrices, and adds matrix classes/functions -->
    <!-- https://github.com/evanw/lightgl.js/ -->
    <script type="text/javascript" src="lib/lightgl.js"></script>
    
    <!--<script type="text/javascript" src="bitmap.js"></script>-->
    <script type="text/javascript" src="colorbrewer.js"></script>
    <script type="text/javascript" src="binarytojson.js"></script>    

</body>
</html>